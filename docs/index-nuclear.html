<!DOCTYPE html>
<html lang="en" style="background: #0f0f23 !important; margin: 0 !important; padding: 0 !important; height: 100% !important; width: 100% !important;">
<head>
  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" href="apple-touch-icon.png">
  <meta name="theme-color" content="#0f0f23">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="application-name" content="Heartnotes">
  <meta name="apple-mobile-web-app-title" content="Heartnotes">
  <meta name="msapplication-TileColor" content="#0f0f23">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-touch-fullscreen" content="yes">
  <meta name="format-detection" content="telephone=no">
  <meta name="apple-mobile-web-app-orientations" content="portrait">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"/>
  <title>Heartnotes</title>
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
</head>
<body style="background: linear-gradient(180deg, #0f0f23 0%, #1a1a2e 50%, #16213e 100%) !important; margin: 0 !important; padding: 0 !important; font-family: Georgia, serif; color: #ffffff; text-align: center; min-height: 100vh; display: flex; flex-direction: column; overflow-x: hidden; -webkit-user-select: none; user-select: none; -webkit-touch-callout: none; -webkit-tap-highlight-color: transparent; position: fixed; width: 100% !important; height: 100% !important; overscroll-behavior: none;">

  <!-- Animated Stars Background -->
  <div id="stars" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 0; background: transparent;"></div>

  <!-- Header -->
  <div style="position: fixed; top: 0; left: 0; right: 0; height: 60px; background: rgba(15, 15, 35, 0.9); backdrop-filter: blur(10px); display: flex; align-items: center; justify-content: space-between; padding: 0 20px; z-index: 1000; border-bottom: 1px solid rgba(255, 255, 255, 0.1);">
    <div style="font-size: 24px; background: transparent;">☀️</div>
    <button onclick="signOut()" style="display: none; background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%); color: white; border: none; padding: 8px 16px; border-radius: 20px; cursor: pointer; font-size: 14px; transition: all 0.2s ease; box-shadow: 0 4px 10px rgba(99, 102, 241, 0.3);" id="signOutBtn">Sign Out</button>
  </div>

  <!-- Welcome Screen -->
  <div id="welcome-screen" style="flex: 1; display: flex; flex-direction: column; justify-content: center; align-items: center; padding: 80px 20px 20px; position: relative; z-index: 1; background: transparent; opacity: 0; transform: translateY(20px); transition: all 0.3s ease;">
    <div style="font-style: italic; font-size: 18px; color: #e2e8f0; margin-bottom: 40px; max-width: 300px; line-height: 1.6; background: transparent;">The wound is the place where the light enters you. - Rumi</div>
    <button onclick="showInspireMe()" style="background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%); color: white; border: none; padding: 16px 32px; border-radius: 30px; font-size: 18px; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 8px 20px rgba(99, 102, 241, 0.4), 0 0 30px rgba(139, 92, 246, 0.3); margin-bottom: 20px;">Inspire Me</button>
    <h1 style="font-size: 36px; font-weight: bold; background: linear-gradient(135deg, #a855f7, #6366f1); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; margin-bottom: 20px;">My Spiritual Journey</h1>
    <p style="font-size: 16px; color: #cbd5e1; margin-bottom: 40px; background: transparent;">Tap the plus button to start your journey</p>
  </div>

  <!-- Main Screen -->
  <div id="main-screen" style="flex: 1; display: none; flex-direction: column; justify-content: center; align-items: center; padding: 80px 20px 20px; position: relative; z-index: 1; background: transparent; opacity: 0; transform: translateY(20px); transition: all 0.3s ease;">
    <button id="back-to-inspire-btn" onclick="goBackToInspire()" style="display: none; margin-bottom: 20px; background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%); color: white; border: none; padding: 12px 24px; border-radius: 25px; cursor: pointer; font-size: 16px; transition: all 0.2s ease; box-shadow: 0 4px 10px rgba(99, 102, 241, 0.3);">← Back to Inspire Me</button>
    <div id="welcome-message" style="display: none; margin-bottom: 20px; font-size: 18px; color: #e2e8f0; padding: 20px; background: rgba(15, 15, 35, 0.8); border-radius: 15px; border: 1px solid rgba(255, 255, 255, 0.1); max-width: 400px; line-height: 1.6;"></div>
    <textarea id="reflection" placeholder="Speak or type your reflections..." style="width: 100%; max-width: 400px; min-height: 200px; padding: 20px; border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 15px; background: rgba(15, 15, 35, 0.8) !important; color: white; font-size: 16px; font-family: Georgia, serif; resize: vertical; margin-bottom: 20px;"></textarea>
    <div style="display: flex; gap: 8px; margin: 15px 0; padding: 12px; background: transparent; justify-content: center; align-items: center; flex-wrap: wrap;">
      <button type="button" onclick="newQuestion()" style="display: flex; align-items: center; justify-content: center; padding: 8px 16px; border-radius: 25px; background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%); color: #ffffff; border: none; cursor: pointer; transition: all 0.2s ease; font-size: 0.9rem; font-weight: 400; white-space: nowrap; box-shadow: 0 4px 10px rgba(99, 102, 241, 0.3), 0 0 20px rgba(139, 92, 246, 0.2); text-decoration: none;">New</button>
      <label for="image-input" style="display: flex; align-items: center; justify-content: center; padding: 8px 16px; border-radius: 25px; background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%); color: #ffffff; border: none; cursor: pointer; transition: all 0.2s ease; font-size: 0.9rem; font-weight: 400; white-space: nowrap; box-shadow: 0 4px 10px rgba(99, 102, 241, 0.3), 0 0 20px rgba(139, 92, 246, 0.2); text-decoration: none;">Photos</label>
      <label for="camera-input" style="display: flex; align-items: center; justify-content: center; padding: 8px 16px; border-radius: 25px; background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%); color: #ffffff; border: none; cursor: pointer; transition: all 0.2s ease; font-size: 0.9rem; font-weight: 400; white-space: nowrap; box-shadow: 0 4px 10px rgba(99, 102, 241, 0.3), 0 0 20px rgba(139, 92, 246, 0.2); text-decoration: none;">Camera</label>
      <button type="button" onclick="startVoiceRecognition()" style="display: flex; align-items: center; justify-content: center; padding: 8px 16px; border-radius: 25px; background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%); color: #ffffff; border: none; cursor: pointer; transition: all 0.2s ease; font-size: 0.9rem; font-weight: 400; white-space: nowrap; box-shadow: 0 4px 10px rgba(99, 102, 241, 0.3), 0 0 20px rgba(139, 92, 246, 0.2); text-decoration: none;">Voice</button>
      <button type="button" id="save" onclick="saveReflection()" disabled style="display: flex; align-items: center; justify-content: center; padding: 8px 16px; border-radius: 25px; background: #4b5563; color: #ffffff; border: none; cursor: not-allowed; transition: all 0.2s ease; font-size: 0.9rem; font-weight: 400; white-space: nowrap; box-shadow: 0 4px 10px rgba(99, 102, 241, 0.3), 0 0 20px rgba(139, 92, 246, 0.2); text-decoration: none;">Save</button>
      <button type="button" onclick="goBack()" style="display: flex; align-items: center; justify-content: center; padding: 8px 16px; border-radius: 25px; background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%); color: #ffffff; border: none; cursor: pointer; transition: all 0.2s ease; font-size: 0.9rem; font-weight: 400; white-space: nowrap; box-shadow: 0 4px 10px rgba(99, 102, 241, 0.3), 0 0 20px rgba(139, 92, 246, 0.2); text-decoration: none;">Back</button>
    </div>
    <input type="file" id="image-input" accept="image/*" multiple style="display: none;" onchange="handleImageUpload(event)">
    <input type="file" id="camera-input" accept="image/*" capture="environment" style="display: none;" onchange="handleImageUpload(event)">
  </div>

  <!-- Floating Action Button -->
  <button onclick="showMainScreen()" id="fabBtn" style="position: fixed; bottom: 30px; right: 30px; width: 60px; height: 60px; border-radius: 50%; background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%); color: white; border: none; font-size: 24px; cursor: pointer; box-shadow: 0 8px 20px rgba(99, 102, 241, 0.4); z-index: 1000; transition: all 0.3s ease;">+</button>

  <script>
    // Firebase Configuration
    const firebaseConfig = {
      apiKey: "AIzaSyBxqgzKJBk7SZzRqVMgQJTEVRIqVZUOz1Y",
      authDomain: "spiritual-journey-e3330.firebaseapp.com",
      projectId: "spiritual-journey-e3330",
      storageBucket: "spiritual-journey-e3330.appspot.com",
      messagingSenderId: "123456789012",
      appId: "1:123456789012:web:abcdef123456"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    // Create animated stars
    function createStars() {
      const starsContainer = document.getElementById('stars');
      const starCount = 50;
      
      for (let i = 0; i < starCount; i++) {
        const star = document.createElement('div');
        star.style.position = 'absolute';
        star.style.background = '#ffffff';
        star.style.borderRadius = '50%';
        star.style.animation = 'twinkle 3s infinite';
        star.style.left = Math.random() * 100 + '%';
        star.style.top = Math.random() * 100 + '%';
        star.style.width = Math.random() * 3 + 1 + 'px';
        star.style.height = star.style.width;
        star.style.animationDelay = Math.random() * 3 + 's';
        starsContainer.appendChild(star);
      }
      
      // Add keyframes for twinkle animation
      const style = document.createElement('style');
      style.textContent = `
        @keyframes twinkle {
          0%, 100% { opacity: 0.3; }
          50% { opacity: 1; }
        }
      `;
      document.head.appendChild(style);
    }

    // Navigation functions
    function showInspireMe() {
      document.getElementById('welcome-screen').style.display = 'none';
      const mainScreen = document.getElementById('main-screen');
      mainScreen.style.display = 'flex';
      setTimeout(() => {
        mainScreen.style.opacity = '1';
        mainScreen.style.transform = 'translateY(0)';
      }, 10);
      document.getElementById('fabBtn').style.display = 'none';
      newQuestion();
    }

    function showMainScreen() {
      document.getElementById('welcome-screen').style.display = 'none';
      const mainScreen = document.getElementById('main-screen');
      mainScreen.style.display = 'flex';
      setTimeout(() => {
        mainScreen.style.opacity = '1';
        mainScreen.style.transform = 'translateY(0)';
      }, 10);
      document.getElementById('fabBtn').style.display = 'none';
    }

    function goBack() {
      document.getElementById('main-screen').style.display = 'none';
      const welcomeScreen = document.getElementById('welcome-screen');
      welcomeScreen.style.display = 'flex';
      setTimeout(() => {
        welcomeScreen.style.opacity = '1';
        welcomeScreen.style.transform = 'translateY(0)';
      }, 10);
      document.getElementById('fabBtn').style.display = 'block';
      document.getElementById('reflection').value = '';
      document.getElementById('save').disabled = true;
      document.getElementById('save').style.background = '#4b5563';
      document.getElementById('save').style.cursor = 'not-allowed';
    }

    function goBackToInspire() {
      newQuestion();
      document.getElementById('back-to-inspire-btn').style.display = 'none';
    }

    // Spiritual questions array
    const spiritualQuestions = [
      "What brought you peace today?",
      "How did you show compassion to yourself or others?",
      "What are you most grateful for in this moment?",
      "What lesson did life teach you today?",
      "How did you connect with something greater than yourself?",
      "What fears did you face today, and how did you overcome them?",
      "In what ways did you grow spiritually today?",
      "What moments made you feel most alive and present?",
      "How did you practice forgiveness today?",
      "What brought you closer to your authentic self?",
      "What synchronicities or meaningful coincidences did you notice?",
      "How did you honor your inner wisdom today?",
      "What acts of kindness touched your heart?",
      "How did you find balance between doing and being?",
      "What spiritual practices brought you comfort today?"
    ];

    function newQuestion() {
      const randomQuestion = spiritualQuestions[Math.floor(Math.random() * spiritualQuestions.length)];
      document.getElementById('welcome-message').textContent = randomQuestion;
      document.getElementById('welcome-message').style.display = 'block';
      document.getElementById('back-to-inspire-btn').style.display = 'block';
      document.getElementById('reflection').focus();
    }

    // Text input handling
    document.getElementById('reflection').addEventListener('input', function() {
      const saveBtn = document.getElementById('save');
      if (this.value.trim()) {
        saveBtn.disabled = false;
        saveBtn.style.background = 'linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%)';
        saveBtn.style.cursor = 'pointer';
      } else {
        saveBtn.disabled = true;
        saveBtn.style.background = '#4b5563';
        saveBtn.style.cursor = 'not-allowed';
      }
    });

    // Voice recognition
    function startVoiceRecognition() {
      if ('webkitSpeechRecognition' in window) {
        const recognition = new webkitSpeechRecognition();
        recognition.continuous = false;
        recognition.interimResults = false;
        recognition.lang = 'en-US';

        recognition.onstart = function() {
          console.log('Voice recognition started');
        };

        recognition.onresult = function(event) {
          const transcript = event.results[0][0].transcript;
          const textarea = document.getElementById('reflection');
          textarea.value += (textarea.value ? ' ' : '') + transcript;
          textarea.dispatchEvent(new Event('input'));
        };

        recognition.onerror = function(event) {
          console.error('Voice recognition error:', event.error);
        };

        recognition.start();
      } else {
        alert('Voice recognition not supported in this browser.');
      }
    }

    // Image handling
    function handleImageUpload(event) {
      const files = event.target.files;
      for (let file of files) {
        const reader = new FileReader();
        reader.onload = function(e) {
          const textarea = document.getElementById('reflection');
          textarea.value += `\n[Image uploaded: ${file.name}]\n`;
          textarea.dispatchEvent(new Event('input'));
        };
        reader.readAsDataURL(file);
      }
    }

    // Save reflection
    function saveReflection() {
      const reflection = document.getElementById('reflection').value.trim();
      if (!reflection) return;

      console.log('Saving reflection:', reflection);
      
      document.getElementById('reflection').value = '';
      const saveBtn = document.getElementById('save');
      saveBtn.disabled = true;
      saveBtn.style.background = '#4b5563';
      saveBtn.style.cursor = 'not-allowed';
      
      alert('Reflection saved successfully!');
    }

    // Authentication placeholder
    function signOut() {
      console.log('Sign out clicked');
    }

    // Initialize the app
    document.addEventListener('DOMContentLoaded', function() {
      createStars();
      
      setTimeout(() => {
        const welcomeScreen = document.getElementById('welcome-screen');
        welcomeScreen.style.opacity = '1';
        welcomeScreen.style.transform = 'translateY(0)';
      }, 100);
    });
  </script>
</body>
</html>